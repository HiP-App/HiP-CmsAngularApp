<md-card class="default-card">
  <h2>{{ 'manage profile' | translate}}</h2>
  <md-card-content>
    <md-grid-list cols="3" rowHeight="29em">
      <md-grid-tile>
        <hip-upload-picture></hip-upload-picture>
      </md-grid-tile>
      <md-grid-tile [colspan]="2">
        <div class="form-wrap">
          <form novalidate (ngSubmit)="updateUserInfo()" #userinfo="ngForm">
            <div *ngIf="errorMessage" class="alert alert-danger">
              <span>{{ errorMessage }}</span>
            </div>
            <md-input [(ngModel)]="currentUser.email" disabled type="text"
                      placeholder="{{ 'email' | translate }}" #Email="ngModel" name="Email">
            </md-input>
            <md-input [(ngModel)]="currentUser.firstName" type="text"
                      placeholder="{{ 'first name' | translate }}" #FirstName="ngModel" name="FirstName">
            </md-input>
            <md-input [(ngModel)]="currentUser.lastName" type="text"
                      placeholder="{{ 'last name' | translate }}" #LastName="ngModel" name="LastName">
            </md-input>
            <div class="right">
              <button type="submit" md-raised-button color="primary">
                {{ 'save changes' | translate }}
              </button>
              <br><br>
            </div>
          </form>
          <form novalidate (ngSubmit)="changePassword()" #changepass="ngForm">
            <div *ngIf="errorMessage" class="alert alert-danger">
              <span>{{ errorMessage }}</span>
            </div>
            <md-input [(ngModel)]="user.oldPassword" required minlength="6" type="password"
                      placeholder="{{ 'password prompt current' | translate }}"
                      pattern="/^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?&])[A-Za-z\d$@$!%*#?&]{6,}$/"
                      #oldPassword="ngModel" name="oldPassword">
            </md-input>
            <md-input [(ngModel)]="user.newPassword" required minlength="6" type="password"
                      placeholder="{{ 'password prompt new' | translate }}"
                      pattern="(?=^.{6,255}$)(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).*"
                      #newPassword="ngModel" name="newPassword" validateEqual="confirmPass" reverse="true">
              <md-hint [hidden]="newPassword.valid || (newPassword.pristine && !changepass.submitted) || user.newPassword.length == 0" class="error-hint">
                <span *ngIf="user.newPassword.length < 6">{{ 'password length' | translate }}</span>
                <span *ngIf="user.newPassword.length > 5 && !passwordValid()">{{ 'password invalid' | translate }}</span>
              </md-hint>
            </md-input>
            <md-input [(ngModel)]="user.confirmPass" required type="password" name="confirmPass"
                      placeholder="{{ 'password retype...' | translate }}"
                      pattern="(?=^.{6,255}$)(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).*" validateEqual="newPassword" reverse="true"
                      #confirmPass="ngModel">
              <md-hint [hidden]="confirmPass.valid || (confirmPass.pristine && !changepass.submitted)" class="error-hint">
                <span *ngIf="user.confirmPass !== user.newPassword">{{ 'password match' | translate }}</span>
              </md-hint>
            </md-input>
            <div class="right">
              <button type="submit" [disabled]="user.confirmPass !== user.newPassword" md-raised-button color="primary">
                {{ 'save changes' | translate }}
              </button>
              <br><br>
            </div>
          </form>
        </div>
      </md-grid-tile>
    </md-grid-list>
  </md-card-content>
</md-card>
