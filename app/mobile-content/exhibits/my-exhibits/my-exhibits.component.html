<md-card class="default-card">
  <h1>{{ !inDeletedPage ? ( 'my exhibits' | translate ) : 'Deleted exhibits'}}</h1>
</md-card>

<md-card class="default-card">
  <div id="exhibit-search">
    <md-input-container>
      <input mdInput placeholder="{{ 'search...' | translate }}" [(ngModel)]="searchQuery" (ngModelChange)="findExhibits()">
    </md-input-container>

    <button md-icon-button *ngIf="showingSearchResults" (click)="resetSearch()" title="{{ 'reset search' | translate }}">
      <md-icon>close</md-icon>
    </button>
    <button md-icon-button color="primary" [disabled]="searchQuery.trim().length < 1" (click)="findExhibits()" title="{{ 'search' | translate }}">
      <md-icon>search</md-icon>
    </button>

    <md-select [(ngModel)]="selectedStatus" (ngModelChange)="reloadList()" placeholder="{{ 'filter by status' | translate }}">
      <md-option *ngFor="let status of statuses" [value]="status">
        {{ status | translate }}
      </md-option>
    </md-select>

    <md-select [(ngModel)]="selectedRoute" (ngModelChange)="reloadList()" placeholder="{{ 'filter by route' | translate }}">
      <md-option *ngFor="let route of routes" [value]="route.id">
        {{ route.title | translate }}
      </md-option>
    </md-select>

  </div>

  <md-nav-list>
    <md-list-item [routerLink]="['/mobile-content/exhibits/view', match.id]" ng-blur="true" *ngFor="let match of matches | paginate: { id: 'server',
                                                                  itemsPerPage: exhibitsPerPage,
                                                                  currentPage: currentPage,
                                                                  totalItems: totalItems }">

        <img md-list-avatar *ngIf="previewsLoaded && previews.has(match.id); else exhibitIcon" [src]="previews.get(match.id)"
          alt="{{ 'image preview' | translate }}" [ngStyle]="{'width.px': 48, 'height.px': 48}">
        <ng-template #exhibitIcon>
          <md-icon md-list-icon class="type-icon" [ngStyle]="{'font-size.px': 40, 'height.px': 40, 'width.px': 40}">place</md-icon>
        </ng-template>
        <h2 md-line>{{ match.name }} ({{ match.status | translate }})
          <hip-star-rating class="fix-position" *ngIf="match.ratings" [rating]='match.ratings' [exhibitId]='match.id'></hip-star-rating>
        </h2>
        <p md-line>{{ match.description }}</p>
        <p md-line>
          <span class="latitude">{{ match.latitude }}</span>,
          <span class="longitude">{{ match.longitude }}</span>
        </p>
        <p *ngIf="match.tags.length > 0" md-line>
          <span *ngFor="let tag of match.tags" class="tag-name">{{ tag }}</span>
        </p>
        <button md-icon-button color="primary" [routerLink]="['/mobile-content/exhibits/edit', match.id]" title="{{ 'edit' | translate }}">
          <md-icon>{{ !inDeletedPage ? 'edit' : 'remove_red_eye'}}</md-icon>
        </button>
        <button md-icon-button color="warn" (click)="deleteExhibit(exhibit)" *ngIf="!match.used && !inDeletedPage" title="{{ 'delete' | translate }}">
          <md-icon>delete_forever</md-icon>
        </button>
    </md-list-item>
  </md-nav-list>

  <hip-pagination (pageChange)="getPage($event)" *ngIf="matches !== undefined && matches.length > 0"></hip-pagination>
</md-card>

<md-card class="default-card">
  <agm-map [zoom]=15 [latitude]="lat" [longitude]="lng">
    <agm-marker *ngFor="let exhibit of matches" [latitude]="exhibit.latitude" [longitude]="exhibit.longitude" [title]="exhibit.name"
      [opacity]="getOpacity(exhibit)"></agm-marker>
  </agm-map>
</md-card>